<!doctype html>
<html lang="ru">
<head>
   <meta charset="utf-8" />
   <meta name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, shrink-to-fit=no, viewport-fit=cover'>
   <meta http-equiv='X-UA-Compatible' content='ie=edge'>
   <title>Yandex Auth</title>
   <script src="https://yastatic.net/s3/passport-sdk/autofill/v1/sdk-suggest-token-with-polyfills-latest.js"></script>
   <style>
      body {
         background: #1f2937;
         color: white;
         font-family: Arial, sans-serif;
         display: flex;
         justify-content: center;
         align-items: center;
         height: 100vh;
         margin: 0;
      }
      .loading {
         text-align: center;
      }
      .spinner {
         border: 2px solid #374151;
         border-top: 2px solid #38bdf8;
         border-radius: 50%;
         width: 40px;
         height: 40px;
         animation: spin 1s linear infinite;
         margin: 0 auto 20px;
      }
      @keyframes spin {
         0% { transform: rotate(0deg); }
         100% { transform: rotate(360deg); }
      }
   </style>
</head>
<body>
   <div class="loading">
      <div class="spinner"></div>
      <p>Завершение авторизации...</p>
   </div>
   
   <script>
      window.onload = function() {
         try {
            console.log('yandex-auth.html: Начинаем передачу токена...');
            
            // Пытаемся передать токен
            if (window.YaSendSuggestToken) {
               window.YaSendSuggestToken(window.location.origin, {
                  flag: true
               });
               console.log('yandex-auth.html: Токен передан');
            } else {
               console.error('yandex-auth.html: YaSendSuggestToken не найден');
            }
            
            // Закрываем окно через небольшую задержку
            setTimeout(() => {
               window.close();
            }, 1000);
            
         } catch (error) {
            console.error('yandex-auth.html: Ошибка:', error);
            alert('Ошибка авторизации. Попробуйте еще раз.');
            window.close();
         }
      };
   </script>
</body>
</html> 